YUI.add("gallery-sm-treeview",function(e,t){var n=e.ClassNameManager.getClassName,r=e.Base.create("treeView",e.View,[e.Tree,e.Tree.Labelable,e.Tree.Openable,e.Tree.Selectable],{classNames:{canHaveChildren:n("treeview-can-have-children"),children:n("treeview-children"),hasChildren:n("treeview-has-children"),icon:n("treeview-icon"),indicator:n("treeview-indicator"),label:n("treeview-label"),node:n("treeview-node"),noTouch:n("treeview-notouch"),open:n("treeview-open"),row:n("treeview-row"),selected:n("treeview-selected"),touch:n("treeview-touch"),treeview:n("treeview")},rendered:!1,templates:e.TreeView.Templates,_isYUITreeView:!0,initializer:function(t){t&&t.templates&&(this.templates=e.merge(this.templates,t.templates)),this._attachTreeViewEvents()},destructor:function(){this._detachTreeViewEvents()},getHTMLNode:function(e){return e._htmlNode||(e._htmlNode=this.get("container").one("#"+e.id)),e._htmlNode},render:function(){var t=this.get("container"),n="ontouchstart"in e.config.win;return t.addClass(this.classNames.treeview),t.addClass(this.classNames[n?"touch":"noTouch"]),this._childrenNode=this.renderChildren(this.rootNode,{container:t}),t.inDoc()||e.one("body").append(t),this.rendered=!0,this},renderChildren:function(t,n){n||(n={});var r=n.container,i=r&&r.one("."+this.classNames.children),s=this._lazyRender;i||(i=e.Node.create(this.templates.children({classNames:this.classNames,node:t,treeview:this})));if(t.hasChildren()){i.set("aria-expanded",t.isOpen());for(var o=0,u=t.children.length;o<u;o++){var a=t.children[o];this.renderNode(a,{container:i,renderChildren:!s||a.isOpen()})}}return t.state.renderedChildren=!0,r&&r.append(i),i},renderNode:function(t,n){n||(n={});var r=this.classNames,i=t.hasChildren(),s=t._htmlNode,o={},u;o[r.node]=!0,o[r.canHaveChildren]=!!t.canHaveChildren,o[r.hasChildren]=i,o[r.open]=t.isOpen();if(s){s.one("."+r.label).setHTML(t.label);for(u in o)o.hasOwnProperty(u)&&s.toggleClass(u,o[u])}else{var a=[];for(u in o)o.hasOwnProperty(u)&&o[u]&&a.push(u);s=t._htmlNode=e.Node.create(this.templates.node({classNames:r,nodeClassNames:a,node:t,treeview:this}))}return i&&n.renderChildren&&this.renderChildren(t,{container:s}),t.state.rendered=!0,n.container&&n.container.append(s),s},_attachTreeViewEvents:function(){this._treeViewEvents||(this._treeViewEvents=[]);var e=this.classNames,t=this.get("container");this._treeViewEvents.push(this.after({add:this._afterAdd,clear:this._afterClear,close:this._afterClose,multiSelectChange:this._afterTreeViewMultiSelectChange,open:this._afterOpen,remove:this._afterRemove,select:this._afterSelect,unselect:this._afterUnselect}),t.on("mousedown",this._onMouseDown,this),t.delegate("click",this._onIndicatorClick,"."+e.indicator,this),t.delegate("click",this._onRowClick,"."+e.row,this),t.delegate("dblclick",this._onRowDoubleClick,"."+e.canHaveChildren+" > ."+e.row,this))},_detachTreeViewEvents:function(){(new e.EventHandle(this._treeViewEvents)).detach()},_setLazyRender:function(e){return this._lazyRender=e},_afterAdd:function(e){if(!this.rendered)return;var t=e.parent,n,r;if(t===this.rootNode)n=this._childrenNode;else{r=this.renderNode(t),n=r.one("."+this.classNames.children);if(!n){this.renderChildren(t,{container:r});return}}n.insert(this.renderNode(e.node,{renderChildren:!this._lazyRender||e.node.isOpen()}),e.index)},_afterClear:function(){if(!this.rendered)return;delete this._childrenNode,this.rendered=!1,this.get("container").empty(),this.render()},_afterClose:function(e){if(!this.rendered)return;var t=this.getHTMLNode(e.node);t.removeClass(this.classNames.open),t.set("aria-expanded",!1)},_afterOpen:function(e){if(!this.rendered)return;var t=e.node,n=this.getHTMLNode(t);t.state.renderedChildren||this.renderChildren(t,{container:n}),n.addClass(this.classNames.open),n.set("aria-expanded",!0)},_afterRemove:function(e){if(!this.rendered)return;var t=this.getHTMLNode(e.node);t&&(t.remove(!0),delete e.node._htmlNode),e.parent&&this.renderNode(e.parent)},_afterSelect:function(e){if(!this.rendered)return;var t=this.getHTMLNode(e.node);t.addClass(this.classNames.selected),this.get("multiSelect")?t.set("aria-selected",!0):t.set("tabIndex",0).focus()},_afterTreeViewMultiSelectChange:function(e){if(!this.rendered)return;var t=this.get("container"),n=t.one("> ."+this.classNames.children),r=t.all("."+this.classNames.node);e.newVal?(n.set("aria-multiselectable",!0),r.set("aria-selected",!1)):(n.removeAttribute("aria-multiselectable"),r.removeAttribute("aria-selected"))},_afterUnselect:function(e){if(!this.rendered)return;var t=this.getHTMLNode(e.node);t.removeClass(this.classNames.selected),this.get("multiSelect")&&t.set("aria-selected",!1),t.removeAttribute("tabIndex")},_onIndicatorClick:function(e){var t=e.currentTarget.ancestor("."+this.classNames.row);e.stopImmediatePropagation(),this.getNodeById(t.getData("node-id")).toggleOpen()},_onMouseDown:function(e){e.preventDefault()},_onRowClick:function(e){var t=this.getNodeById(e.currentTarget.getData("node-id"));this.get("multiSelect")?t[t.isSelected()?"unselect":"select"]():t.select()},_onRowDoubleClick:function(e){this.getNodeById(e.currentTarget.getData("node-id")).toggleOpen()}},{ATTRS:{lazyRender:{lazyAdd:!1,setter:"_setLazyRender",value:!0}}});e.TreeView=e.mix(r,e.TreeView)},"gallery-2013.03.27-22-06",{requires:["base-build","classnamemanager","gallery-sm-treeview-templates","tree","tree-labelable","tree-openable","tree-selectable","view"],skinnable:!0});
